services:
  signaling:
    build: .
    restart: unless-stopped
    ports:
      - "3456:3000"
    env_file: .env

  coturn:
    image: coturn/coturn:latest
    restart: unless-stopped
    network_mode: host
    volumes:
      - ./turnserver.conf:/etc/coturn/turnserver.conf:ro
      - ./certs:/etc/coturn/certs:ro
    command: >
      -c /etc/coturn/turnserver.conf
      --static-auth-secret=${TURN_SECRET}
      --realm=${TURN_DOMAIN}
      --external-ip=${VPS_PUBLIC_IP}
    depends_on:
      - signaling
